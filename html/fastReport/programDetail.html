<!DOCTYPE html>
<html>

<head>
	<meta name="viewport" content="width=device-width, minimum-scale=1, maximum-scale=1">
	<meta charset="UTF-8">
	<title></title>
	<link rel="stylesheet" href="../../css/iuapmobile.um.css">
	<link rel="stylesheet" href="../../css/fonts/iconfont.css">
	<script src="../../js/font.js"></script>
	<style>
		div.Artical>div {
			display: none;
			color: #555;
		}

		.um-tabbar.um-tabbar-underline {
			background-color: white;
		}

		div.Artical>div.active {
			display: block;
		}

		.flow p.title {
			font-size: 0.28rem;
			color: #333;
			line-height: 0.9rem;
		}

		.contentFlow {
			margin-top: 0.2rem;
			padding-left: 0.6rem;
			overflow: hidden;
		}

		.contentFlow .listItem {
			border-left: 2px dotted #ddd;
			margin-left: 0.34rem;
			min-height: 2rem;
			padding-right:0.3rem;
		}

		.contentFlow .listItem:last-child {
			border-left: 0px dotted #ddd;

		}

		.contentFlow .listItem:first-child {
			margin-top: 0.4rem;
		}

		.contentFlow .listItem p.top {
			color: #039be5;
			font-size: 0.32rem;
			padding-left: 0.24rem;
		}

		.contentFlow .listItem .inside {
			position: relative;
			padding-bottom: 0.32rem;
			border-bottom: 1px solid #f7f7f7;
		}

		.contentFlow .listItem .inside img.true {
			position: absolute;
			z-index: 100;
			top: 0.06rem;
			left: -0.14rem;
			width: 0.28rem;
		}

		.contentFlow .listItem:first-child .inside img.true {
			top: 0.02rem;
		}

		.contentFlow .listItem p.content {
			color: #9e9e9e;
			font-size: 0.28rem;
			padding-left: 0.24rem;
		}

		ul.um-tabbar li a {
			display: inline-block;
			line-height: 0.7rem;
			height: 0.7rem;
		}

		.listContent:first-child {
			margin-top: 0px;
		}

		.listContent {
			border-radius: 5px;
			margin-top: 0.2rem;
			background: #fff;
		}

		.listContent p.title {
			color: #333;
			font-size: 0.36rem;
			position: relative;
			line-height: 0.9rem;
			padding-left: 0.5rem;
		}

		.listContent p {
			padding: 0 0.54rem;
			font-size: 0.28rem;
			line-height: 0.9rem;

		}

		.listContent p span {
			color: #424242;
		}

		.um-tabbar-underline>li.active {
			color: #039be5;
			border-color: #039be5;
		}

		.listContent p.title:before {
			content: "";
			width: 3px;
			height: 0.32rem;
			background: #039be5;
			position: absolute;
			left: 0.4rem;
			top: 0.26rem;
		}

		.um-tabbar-underline>li.active>a {
			color: #039be5;
		}

		.listContent p {
			line-height: 0.9rem;
			border-bottom: 1px solid #f7f7f7;
			color: #666;
			font-size: 0.32rem;
		}
	</style>

</head>

<body>
	<div class="um-win" id="programDetail">
		<ul class="um-tabbar um-tabbar-underline um-tabbar-switch">
			<li data-tar='.base' class="active tc"><a>基本信息</a></li>
			<li class=" tc" data-tar='.flow'><a>评审流程</a></li>
		</ul>
		<div class="um-content">
			<div class="Artical">
				<div class="base  active">
					<div class="list listContent">

						<p class="title">基本信息</p>
						<p class="pl10 pr10">客户信息<span class="fr">{{dataList?dataList.ProjectObj.CLIENT_NAME:""}}</span></p>
						<p class="pl10 pr10">合同编号<span class="fr">{{dataList?dataList.ProjectObj.LEASE_CODE:""}}</span></p>
						<p class="pl10 pr10">业务模式<span class="fr">{{dataList?dataList.ProjectObj.PLATFORM:""}}</span></p>
						<!--<p class="pl10 pr10">所属门店<span class="fr">{{dataList.ProjectObj.PLATFORM}}</span></p>-->
						<p class="pl10 pr10">客户经理<span class="fr">{{dataList?dataList.ProjectObj.EMPLOYEE_NAME:""}}</span></p>
					</div>
					<div class="list listContent" v-for="(item,index) in dataList.EquipObj">
						<p class="title pl10">车辆信息{{(dataList.EquipObj.length>1)?index+1:""}}</p>
						<p class="pl10 pr10">经销商<span class="fr">{{item.SUPPLIERS_NAME}}</span></p>
						<p class="pl10 pr10">厂商<span class="fr">{{item.COMPANY_NAME}}</span></p>
						<p class="pl10 pr10">品牌<span class="fr">{{item.PRODUCT_NAME}}</span></p>
						<p class="pl10 pr10">数量<span class="fr">{{item.AMOUNT}}</span></p>
						<p class="pl10 pr10">车型<span class="fr">{{item.CATENA_NAME}}</span></p>
						<!--<p class="pl10 pr10">颜色<span class="fr">{{dataList.prjBscInfo.prjEqiDtlCar.carCl}}</span></p>-->
						<p class="pl10 pr10">成交价<span class="fr">{{item.TOTAL}}</span></p>
					</div>
					<div class="list listContent">
						<p class="title pl10">报价方案</p>
						<!-- <p class="pl10 pr10">方案名称<span class="fr">{{dataList.schName}}</span></p> -->
						<p class="pl10 pr10">租赁物总价值<span class="fr">{{dataSchemeList.TOTAL_MONTH_PRICE}} </span></p>
						<p class="pl10 pr10">合同额<span class="fr">{{dataSchemeList.LEASE_TOPRIC}} </span></p>
						<p class="pl10 pr10">首付比例<span class="fr">{{dataSchemeList.START_PERCENT}}%</span></p>
						<p class="pl10 pr10">首期租金<span class="fr">{{dataSchemeList.FIRST_MONEY}}</span></p>
						<p class="pl10 pr10">保证金<span class="fr">{{dataSchemeList.DEPOSIT_MONEY}}</span></p>
						<!--<p class="pl10 pr10">咨询费比例<span class="fr">{{dataSchemeList.TOTAL_MONTH_PRICE}}</span></p>-->
						<p class="pl10 pr10">咨询费<span class="fr">{{dataSchemeList.POUNDAGE_PRICE}}</span></p>
						<p class="pl10 pr10">年利率<span class="fr">{{dataSchemeList.YEAR_INTEREST}}%</span></p>
						<p class="pl10 pr10">租赁期数<span class="fr">{{dataSchemeList.LEASE_TERM}}月</span></p>
						<p class="pl10 pr10">支付方式<span class="fr">{{dataSchemeList.PAY_WAY_NM}}</span></p>
					</div>
				</div>
				<div class="flow" >
					<div id="flowContent"></div>
					<p class="title   tc um-bgc-white" v-show="JBPM_ID_NM" >流程ID：{{JBPM_ID_NM}}</p>
					<div class="contentFlow um-bgc-white">
						<div class="listItem" v-for="(item,index) in JBPM_ID">
							<div class="inside">
								<img src="../../img/true.png" class="true" alt="" />
								<p class="top">{{item.TASK_NAME}}</p>
								<p class="content">【{{item.OP_CODE}}】{{item.OP_NAME}}: {{item.OP_TYPE}} </p>
									<p class="content">审批意见：{{item.MEMO?item.MEMO:"无"}}  </p>
								<p class="content"> {{item.OP_TIME}}</p>
							</div>
						</div>
					</div>


				</div>
			</div>
		</div>
	</div>
</body>
<script src="../../js/summer.js"></script>
<script src="../../js/jquery.min.js"></script>
<script src="../../js/vue.js"></script>
<script src="../../js/common.js"></script>
<script src="../../js/Frameworks/iuapmobile.frameworks.ui.js"></script>
<script>
	summerready = function() {
		var detailId = summer.pageParam.id;
		var JBPM_ID= summer.pageParam.JBPM_ID;
		programDetail.project_id=detailId;
		programDetail.getData(detailId);
		programDetail.getJBPMData(JBPM_ID);
		//	programDetail.getSchemeData(detailId);
	};
	var programDetail = new Vue({
		el: '#programDetail',
		data() {
			return {
				dataList: "",
				dataSchemeList:"",
				project_id:"",
				JBPM_ID_NM:"",
				JBPM_ID:""
			}
		},
		created() {


		},
		methods: {
			getData(id) {
				let self = this;
				ajaxRequest({
					type: 'post',
					url: 'appservice/foundproject/loadProjectPage',
					param: {
						"PROJECT_ID": id,
					}
				}, function(res) {
					summer.hideProgress();
					if (res.data.flag == 1) {
						self.dataList = res.data.datas;
						self.getSchemeData(self.project_id);
						console.log(self.dataList);
					}
				}, function(err) {
					alert(err);
					console.log(err);
					summer.hideProgress();
				});

			},
			getSchemeData(id){
				let self = this;
				ajaxRequest({
					type: 'post',
					url: 'appservice/foundproject/queryProjectScheme',
					param: {
						"PROJECT_ID": id,
					}
				}, function(res) {
					summer.hideProgress();
					if (res.data.flag == 1) {
						self.dataSchemeList = res.data.datas.scheme;
						console.log(self.dataSchemeList);
					}
				}, function(err) {
					alert(err);
					console.log(err);
					summer.hideProgress();
				});

			},
		  getJBPMData(JBPM_ID){
				let self = this;
				if (JBPM_ID) {
					$("#content").css('display', 'none');
					self.JBPM_ID_NM=JBPM_ID;
					ajaxRequest({
						type: 'post',
						url: 'appservice/bpmtask/showbpmTask',
						param: {
							"JBPM_ID": JBPM_ID,
						}
					}, function(res) {
						summer.hideProgress();
						if (res.data.flag == 1) {
							self.JBPM_ID=res.data.datas;
							console.log(res);
						}
					}, function(err) {
						alert(err);
						console.log(err);
						summer.hideProgress();
					});
				} else {
						createNull("flowContent", "../../img/empty.png","暂未发起流程");
						$("#content").css('display', 'block');
				}

			}
		}
	});
	$(function() {
		/*导航更换js*/
		$('ul.um-tabbar-switch  Li').click(function() {
			$(this).addClass('active').siblings('.active').removeClass('active');
			var tar = $(this).attr('data-tar');
			$(tar).addClass('active').siblings('.active').removeClass('active');
		});
	});

	function newCreateCustom() {
		summer.openWin({
			id: 'newCreateCustom',
			url: 'html/fastReport/newCreateCustom.html',
			create: false,
			type: 'actionBar',
			actionBar: {
				title: "客户信息",
				titleColor: "#ffffff", //注意必须是6位数的颜色值。（3位数颜色值会不正常）
				backgroundColor: "#039be5",
				leftItem: {
					image: "img/back.png",
					method: "", //返回按钮自定义事件
					text: "返回",
					textColor: "#ffffff" //返回文字颜色，注意必须是6位数的颜色值。（3位数颜色值会不正常）
				},
				rightItems: [{
					type: "text",
					text: "下一步",
					textColor: "#ffffff", //文字颜色，注意必须是6位数的颜色值。（3位数颜色值会不正常）
					method: "nextStopAction()" //在打开的window中自定义事件
				}]
			}
		});
	}
</script>

</html>
